# TODO

- Delete "old_config" from protobuf definition & UI
- Address ASAN-detected memory leaks
  - `sro::navmesh::triangulation::NavmeshTriangulation::buildNavmeshForRegion`
- eventBroker.cpp:130 handle memory leak when destructed, events lost in handle function
- Get away from include & src directories in silkroad_lib
- It would be really nice to have a local list of known characters
- Add UI element to toggle packet logging to console
- Auto relogin when a character disconnects
- Ensure that no state machine does any work in its constructor
  - Bonus if we can guarantee it
- Remove StateMachineActiveTooLong event
- Remove StateMachineCreated/Destroyed in ctors/dtors
- Make StateMachine::name a virtual function
- Handle the case when state::machine::PickItem's target item is picked by someone else
- If `SequentialStateMachines` is here to stay, rename it as something like `StateMachineQueue`, to represent that once a contained state machine is complete, it is destroyed and removed from the queue
- Change silkroad_lib dir to sro and match the project, so that the include path looks the same as the namespace
- Create a "pvp ledger" which holds all PvpDescriptors. Rather than sending around copies of PvpDescriptors, we can instead share pointers into the ledger
- Additionally, add move constructors for state machines which take in vectors of items, like Walking or GmCommandSpawnAndPickItems
- In the construction of state machines, with its reference to Bot, register itself with the bot. This would make it so that I dont need to manually also write code in the Bot to hold & execute the state machine
- In the construction of state machines, also give a pointer to the parent state machine
  - With this, and a private overridden version of onUpdate, we can catch & rethrow exceptions giving a "stack trace" of which state machine we were in
- Consolidate `type_id::TypeId storage::Item::typeId()` and `TypeId type_id::getTypeId(const sro::pk2::ref::Item &item)`
- Reimplement some version of pathfinding in case a character disconnects while dead and ends up back in town
- Send pings so that if the client crashes, the character does not disconnect
- Stop passing around GameData and make it a global singleton. It is a constant set of data that lots of parts of the code need to access. There's no point in passing it around everywhere
- PacketContainer::Direction::kBotToServer is no different from PacketContainer::Direction::kClientToServer, delete it
- Remove any active buffs before announcing that we're ready for pvp
- In the state machine which enables PVP, if it gets cancelled, start again